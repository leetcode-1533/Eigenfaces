function Z = ICA( X )

%???
[M,T]=size(X);   %?????????????????????????????
average=mean(X')';  %??
for i=1:M
    X(i,:)=X(i,:)-average(i)*ones(1,T);
end

%??/??
Cx=cov(X',1);  %???????Cx
[eigvector,eigvalue]=eig(Cx);   %??Cx?????????
W=eigvalue^(-1/2)*eigvector';   %????
Z=W*X;    %????

%??
Maxcount=10000;  %??????
Critical=0.00001;  %??????
m=M;
W=rand(m);
for n=1:m
    WP=W(:,n);  %?????????
    %Y=WP'*Z;
    %G=Y.^3;%G?????????y^3?
    %GG=3*Y.^2?   %G???
    count=0;
    LastWP=zeros(m,1);
    W(:,n)=W(:,n)/norm(W(:,n));
    while abs(WP-LastWP)&abs(WP+LastWP)>Critical
        count=count+1;  %????
        LastWP=WP;      %??????
        %WP=1/T*Z*((LastWP'*Z).^3)'-3*LastWP;
        for i=1:m
            WP(i)=mean(Z(i,:).*(tanh((LastWP)'*Z)))-(mean(1-(tanh((LastWP))'*Z).^2)).*LastWP(i);
        end
        WPP=zeros(m,1);
        for j=1:n-1
            WPP=WPP+(WP'*W(:,j))*W(:,j);
        end
        WP=WP-WPP;
        WP=WP/(norm(WP));
        if count==Maxcount
            fprintf('????????');
            return;
        end
    end
    W(:,n)=WP;
end
Z=W'*Z;
end
